import { DataTypes } from "sequelize";
import sequelize from "../db/connection";
import { ClienteModel } from "./clientes";

export const VentasModel = sequelize.define("ventas", {
  idventa: {
    type: DataTypes.INTEGER,
    primaryKey: true,
    autoIncrement: true,
  },
  creferencia: {
    type: DataTypes.STRING,
    allowNull: false,
  },
  fecha: {
    type: DataTypes.DATE,
    allowNull: false,
  },
  factura: {
    type: DataTypes.NUMBER,
  },

  formatofactura: {
    type: DataTypes.STRING,
    allowNull: false,
  },
  vencimiento: {
    type: DataTypes.DATE,
    allowNull: false,
  },
  cliente: {
    type: DataTypes.INTEGER,
    allowNull: false,
    references: {
      model: ClienteModel, // Referencia al modelo de cliente
      key: "codigo", // El campo de clave primaria en el modelo de cliente
    },
  },
  sucursal: {
    type: DataTypes.INTEGER,
    allowNull: false,
  },
  moneda: {
    type: DataTypes.INTEGER,
    allowNull: false,
  },
  comprobante: {
    type: DataTypes.INTEGER,
    allowNull: false,
  },
  cotizacion: {
    type: DataTypes.FLOAT,
    allowNull: false,
  },
  vendedor: {
    type: DataTypes.INTEGER,
    allowNull: false,
  },
  caja: {
    type: DataTypes.INTEGER,
    allowNull: false,
  },
  supago: {
    type: DataTypes.FLOAT,
    allowNull: false,
  },
  sucambio: {
    type: DataTypes.FLOAT,
    allowNull: false,
  },
  exentas: {
    type: DataTypes.FLOAT,
    allowNull: false,
  },
  gravadas10: {
    type: DataTypes.FLOAT,
    allowNull: false,
  },
  gravadas5: {
    type: DataTypes.FLOAT,
    allowNull: false,
  },
  totalneto: {
    type: DataTypes.FLOAT,
    allowNull: false,
  },
  cuotas: {
    type: DataTypes.INTEGER,
    allowNull: false,
  },
  vencimientotimbrado: {
    type: DataTypes.DATE,
    allowNull: false,
  },
  nrotimbrado: {
    type: DataTypes.INTEGER,
    allowNull: false,
  },
    idusuario: {
    type: DataTypes.INTEGER,
    allowNull: false,
  },

});

VentasModel.belongsTo(ClienteModel, { foreignKey: "cliente" });

ClienteModel.hasMany(VentasModel, {
  foreignKey: "cliente",
  sourceKey: "codigo",
  as: "ventas",
});
